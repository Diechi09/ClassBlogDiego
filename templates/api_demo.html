{% extends "base.html" %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-2">
    <h1 class="m-0">API Demo</h1>
    <a class="btn btn-light fw-semibold" href="{{ url_for('api_export_posts') }}">Download All Posts (JSON)</a>
  </div>
  <p class="text-secondary">This page uses <code>fetch()</code> to call your REST endpoints and render results without reloading.</p>

  <div class="card ff-card ff-shadow mb-3">
    <div class="card-body">
      <h4 class="mb-2">Stats</h4>
      <div id="statsContent" class="small">Loading stats…</div>
    </div>
  </div>

  <div class="card ff-card ff-shadow">
    <div class="card-body">
      <h4 class="mb-3">Live Search (from /api/posts)</h4>
      <form id="searchForm" class="row gy-2 gx-2 align-items-center">
        <div class="col-sm-6">
          <input id="q" type="text" class="form-control bg-dark text-light" placeholder="Search posts...">
        </div>
        <div class="col-sm-4">
          <select id="flair" class="form-select bg-dark text-light">
            <option value="">All flairs</option>
            <option value="TRADE_HELP">TRADE HELP</option>
            <option value="WAIVER_WIRE">WAIVER WIRE ADVICE</option>
            <option value="INJURY_TALK">INJURY TALK</option>
            <option value="OTHER">OTHER</option>
          </select>
        </div>
        <div class="col-sm-2">
          <button class="btn btn-light w-100 fw-semibold" type="submit">Search</button>
        </div>
      </form>

      <div id="results" class="mt-3">Type and search to load results…</div>
      <div id="pager" class="mt-2"></div>
    </div>
  </div>

  <script src="{{ url_for('static', filename='api_demo.js') }}"></script>
{% endblock %}
